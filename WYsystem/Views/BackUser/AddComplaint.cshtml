@model WYsystem.Models.w_user
<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>tenant's Personal Center</title>
    <link rel="stylesheet" type="text/css" href="/Content/Owner/UserBack/Css/identify.css" />
    <link rel="stylesheet" type="text/css" href="/Content/Owner/UserBack/Css/layout.css" />
    <link rel="stylesheet" type="text/css" href="/Content/Owner/UserBack/Css/style.css" />
    <link rel="stylesheet" type="text/css" href="/Content/Owner/UserBack/Css/control_index.css" />
    <link rel="stylesheet" href="/Content/Owner/UserBack/Css/bootstrap.min.css">
    <script src="/Content/Owner/UserBack/Js/jquery-1.7.2.min.js"></script>
    <script type="text/javascript" src="/Content/Owner/UserBack/Js/jquery-3.4.1.min.js"></script>
    <script src="/Content/Owner/UserBack/Js/bootstrap.min.js"></script>
    <script type="text/javascript" src="/Content/Owner/UserBack/Js/select.js"></script>
    <script type="text/javascript" src="/Content/Owner/UserBack/Js/haidao.validate.js"></script>
    <style>
        .tobar_title {
            text-align: center;
        }

        .img_Icon {
            width: 16px;
            height: 16px;
            vertical-align: middle;
        }

        .img_nav {
            width: 25px;
            height: 20px;
            vertical-align: middle;
        }

        .edit_user {
            padding: 0 20px 0 20px;
            margin-top: 20px;
        }

        #btnUpload {
            border: 0;
            outline: none;
        }
    </style>
</head>

<body>
    <div class="view-topbar">
        <div class="topbar-console">
            <div class="tobar-head fl">
                <a href="/Home/Index" class="topbar-home-link topbar-btn text-center fl" title="Back"><span>Back</span></a>
            </div>
        </div>
        <div class="topbar-info">
            <ul style="float: right;">
                <li class="fl topbar-info-item">
                    <div class="dropdown">
                        <a href="#" class="topbar-btn" title="Quite">
                            <span class="fl text-normal"><img src="~/Content/img/head.jpg" alt="" style="width: 40px;height: 40px;border-radius: 5px;vertical-align: middle;">&nbsp;&nbsp;@((Session["User"] as WYsystem.Models.w_user ).user_name)</span>
                            <span class="icon-arrow-down"></span>
                        </a>
                        <ul class="dropdown-menu">
                            <li>
                                <a href="/Home/logout" style="text-align: center;">
                                    <h5>Back<img src="/Content/Owner/UserBack/Images/Icon/close.png" alt="" class="img_Icon"></h5>
                                </a>
                            </li>
                        </ul>
                    </div>
                </li>
            </ul>
        </div>
    </div>
    <div class="view-body">
        <div class="view-sidebar">
            <div class="sidebar-content">
                <div class="sidebar-nav">
                    <div class="sidebar-title">
                        <a href="/BackUser/Index" style="text-align:center">
                            <span class="text-normal">Main page</span>
                        </a>
                    </div>
                    <div class="sidebar-title">
                        <a href="#">
                            <span class="sidebar-icon"><img src="/Content/Owner/UserBack/Images/Icon/boult-x.png" class="img_nav" /></span>
                            <span class="text-normal">information</span>
                        </a>
                    </div>
                    <ul class="sidebar-trans">
                        <li>
                            <a href="/BackUser/MyCenter">
                                <span class="sidebar-icon"><img src="/Content/Owner/UserBack/Images/Icon/user1.png" class="img_Icon" /></span>
                                <span class="text-normal">my personal information</span>
                            </a>
                        </li>
                        <li>
                            <a href="/BackUser/EditMyForm">
                                <b class="sidebar-icon"><img src="/Content/Owner/UserBack/Images/icon/edit.png" class="img_Icon" /></b>
                                <span class="text-normal">modify information</span>
                            </a>
                        </li>
                    </ul>
                </div>
                <div class="sidebar-nav">
                    <div class="sidebar-title">
                        <a href="#">
                            <span class="sidebar-icon"><img src="/Content/Owner/UserBack/Images/Icon/boult-x.png" class="img_nav" /></span>
                            <span class="text-normal">Property Charges</span>
                        </a>
                    </div>
                    <ul class="sidebar-trans">
                        <li>
                            <a href="/BackUser/MyCharge">
                                <b class="sidebar-icon"><img src="/Content/Owner/UserBack/Images/Icon/plan.png" class="img_Icon" /></b>
                                <span class="text-normal">My Property Charges</span>
                            </a>
                        </li>
                    </ul>
                </div>
                <div class="sidebar-nav">
                    <div class="sidebar-title">
                        <a href="#">
                            <span class="sidebar-icon"><img src="/Content/Owner/UserBack/Images/Icon/boult-x.png" class="img_nav" /></span>
                            <span class="text-normal">Repair Service</span>
                        </a>
                    </div>
                    <ul class="sidebar-trans">
                        <li>
                            <a href="/BackUser/AddRepair">
                                <b class="sidebar-icon"><img src="/Content/Owner/UserBack/Images/Icon/upload.png" class="img_Icon" /></b>
                                <span class="text-normal">Add Repair</span>
                            </a>
                        </li>
                        <li>
                            <a href="/BackUser/MyRepairRecord">
                                <b class="sidebar-icon"><img src="/Content/Owner/UserBack/Images/Icon/plan3.png" class="img_Icon" /></b>
                                <span class="text-normal">My Repair record</span>
                            </a>
                        </li>
                    </ul>
                </div>
                <div class="sidebar-nav">
                    <div class="sidebar-title">
                        <a href="#">
                            <span class="sidebar-icon"><img src="/Content/Owner/UserBack/Images/Icon/boult-x.png" class="img_nav" /></span>
                            <span class="text-normal">Complaint Service</span>
                        </a>
                    </div>
                    <ul class="sidebar-trans">
                        <li>
                            <a href="/BackUser/AddComplaint">
                                <b class="sidebar-icon"><img src="/Content/Owner/UserBack/Images/Icon/kefu.png" class="img_Icon" /></b>
                                <span class="text-normal">Initiate a complaint</span>
                            </a>
                        </li>
                        <li>
                            <a href="/BackUser/MyComplaintRecord">
                                <b class="sidebar-icon"><img src="/Content/Owner/UserBack/Images/Icon/plan2.png" class="img_Icon" /></b>
                                <span class="text-normal">My complaint record</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="view-product">
            <div class="manage account-manage">
                <div class="manage-head">
                    <h6 class="layout padding-left manage-head-con">Initiate a complaint</h6>
                </div>
                <div class="edit_user">
                    <form>
                        <input type="text" name="name" id="userId" value="@Model.id" style="display:none;" />
                        <div class="form-group">
                            <label>投诉人</label>
                            <input type="text" class="form-control" id="name" value="@Model.user_name" readonly>
                        </div>
                        <div class="form-group">
                            <label>我的地址</label>
                            <input type="text" class="form-control" id="address" value="@Model.link_address" placeholder="请输入我的地址">
                        </div>
                        <div class="form-group">
                            <label>联系电话</label>
                            <input type="text" class="form-control" id="phone" value="@Model.phone" placeholder="请输入联系电话">
                        </div>
                        <div class="form-group">
                            <label>投诉标题</label>
                            <input type="text" class="form-control" id="title" placeholder="请输入投诉标题">
                        </div>
                        <div class="form-group">
                            <label>投诉内容</label>
                            <textarea class="form-control" id="content" rows="10" placeholder="请输入投诉内容"></textarea>
                        </div>
                        <div class="form-group">
                            <label>投诉时间</label>
                            <input type="date" class="form-control" id="time" value="@DateTime.Now.ToString("yyyy-MM-dd")">
                        </div>
                        <input type="hidden" id="houses" name="name" value="@Model.house_id" />
                        <p style="color:red" id="errorText"></p>
                        <button type="button" class="btn btn-primary" id="btnUpload">
                            提交
                        </button>
                        <span id="text_success" style="color: green;font-size: 18px;"></span>
                    </form>
                </div>
            </div>

        </div>
    </div>

    <script>
    $(".sidebar-title").click(function () {
            if ($(this).parent(".sidebar-nav").hasClass("sidebar-nav-fold")) {
                $(this).next().slideDown(200);
                $(this).parent(".sidebar-nav").removeClass("sidebar-nav-fold");
            } else {
                $(this).next().slideUp(200);
                $(this).parent(".sidebar-nav").addClass("sidebar-nav-fold");
            }
        });
        $("#btnUpload").click(function () {
            var uid = $('#userId').val();
            var name = $('#name').val();
            var address = $('#address').val();
            var phone = $('#phone').val();
            var title = $('#title').val();
            var content = $('#content').val();
            var time = $('#time').val();
            var houseId = $("#houses").val();
            if (name == "") {
                document.querySelector("#errorText").innerHTML = "投诉人不能为空！";
                return;
            }
            if (address == "") {
                document.querySelector("#errorText").innerHTML = "地址不能为空！";
                return;
            }
            if (phone == "") {
                document.querySelector("#errorText").innerHTML = "手机号不能为空！";
                return;
            }
            if (title == "") {
                document.querySelector("#errorText").innerHTML = "投诉标题不能为空！";
                return;
            }
            if (content == "") {
                document.querySelector("#errorText").innerHTML = "投诉内容不能为空！";
                return;
            }
            if (time == "") {
                document.querySelector("#errorText").innerHTML = "时间不能为空！";
                return;
            }
            if (confirm('submitted?')) {
                $.ajax({
                    url: '/BackUser/AddComplaint',
                    type: 'Post',
                    data: {
                        uid: uid,
                        name: name,
                        address: address,
                        phone: phone,
                        title: title,
                        describe: content,
                        createtime: time,
                        state: "未审核",
                        is_use:0,
                        house_id:houseId
                    },
                    success: function (data) {
                        if (data == "OK") {
                            $(this).addClass('disabled', 'true')
                            document.querySelector("#text_success").innerHTML = 'Submitted, please wait for staff review';
                            alert('Submitted, please wait for staff review');
                            return;
                        }
                        if (data == "Error") {
                            $(this).addClass('disabled', 'true')
                            document.querySelector("#text_success").innerHTML = 'Sending failure。';
                            return;
                        }
                    },
                    error: function () {
                        alert('Request Error！');
                    }
                })

            }
        })</script>
</body>

</html>